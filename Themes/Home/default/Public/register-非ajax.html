<include file="Public:header" />

<article class="header question">
</article>

<div class="main question register">
    <div class="container" style="max-width:960px">
        <div class="panel panel-default">
            <div class="panel-heading"><h2 class="text-center">用户注册</h2></div>
            <div class="panel-body">
                <form class="register" method="post" action="{:U('/register')}">
                    <div class="form-horizontal">
                        <!--用户名-->
                        <div class="form-group">
                            <label for="inputEmail1" class="col-sm-4 control-label">用户名：</label>
                            <div class="col-sm-4">
                                <input type="text" name="uname" value="{$uname}" class="form-control" id="inputEmail1" placeholder="用户名" >
                            </div>
                            <?php if ($error_uname) { ?>
                                <p class="col-sm-4"><?php echo $error_uname; ?></p>
                            <?php } ?>
                        </div>
                        <!--联系人姓名-->
                        <div class="form-group">
                            <label for="inputEmail2" class="col-sm-4 control-label">联系人姓名：</label>
                            <div class="col-sm-4">
                                <input type="text" name="name" value="{$name}" class="form-control" id="inputEmail2" placeholder="联系人姓名">
                            </div>
                            <?php if ($error_name) { ?>
                                <p class="col-sm-4"><?php echo $error_name; ?></p>
                            <?php } ?>
                        </div>
                        <!--联系人身份证-->
                        <div class="form-group">
                            <label for="inputEmail3" class="col-sm-4 control-label">联系人身份证：</label>
                            <div class="col-sm-4">
                                <input type="text" name="id_card" value="{$id_card}" class="form-control" id="inputEmail3" placeholder="联系人身份证">
                            </div>
                            <?php if ($error_id_card) { ?>
                                <p class="col-sm-4"><?php echo $error_id_card; ?></p>
                            <?php } ?>
                        </div>
                        <!--邀请码-->
                        <div class="form-group">
                            <label for="inputEmail4" class="col-sm-4 control-label">输入推荐人邀请码：</label>
                            <div class="col-sm-4">
                                <input type="text" name="referee_code" value="{$referee_code}" class="form-control" id="inputEmail4" placeholder="输入推荐人邀请码">
                            </div>
                            <?php if ($error_referee_code) { ?>
                                <p class="col-sm-4"><?php echo $error_referee_code; ?></p>
                            <?php } ?>
                        </div>

                        <div class="form-group">
                            <label for="inputEmail4" class="col-sm-4 control-label">居住地址：</label>
                            <div class="col-sm-8">
                                <div class="fl item-ifo">
                                    <div class="o-intelligent-regName">
                                        <select id="loc_province"  style="width:120px;"></select>&nbsp;&nbsp;
                                        <select id="loc_city"  style="width:120px; margin-left: 10px"></select>&nbsp;&nbsp;
                                        <select id="loc_town"  style="width:120px;margin-left: 10px"></select>

                                        <!-- <input type="hidden" name="loc_province" id="loc_province_ok"> -->
                                        <!-- <input type="hidden" name="loc_city" id="loc_city_ok"> -->
                                        <!-- <input type="hidden" name="loc_town" id="loc_town_ok"> -->

                                        <input type="hidden" name="loc_province">
                                        <input type="hidden" name="loc_city" >
                                        <input type="hidden" name="loc_town" >

                                    </div>
                                </div>
                            </div>
                        </div>

                        <link href="__PUBLIC__/css/select2.css" rel="stylesheet"/>
                        <script src="__PUBLIC__/js/jquery.js" type="text/javascript"></script>
                        <script type="text/javascript" src="__PUBLIC__/js/area/area.js"></script>
                        <script type="text/javascript" src="__PUBLIC__/js/area/location.js"></script>
                        <script src="__PUBLIC__/js/area/select2.js"></script>
                        <script src="__PUBLIC__/js/area/select2_locale_zh-CN.js"></script>

                        <!--具体地址-->
                        <div class="form-group">
                            <label for="inputEmail5" class="col-sm-4 control-label">具体地址：</label>
                            <div class="col-sm-4">
                                <input type="text" name="address" value="{$address}" class="form-control" id="inputEmail5" placeholder="具体地址">
                            </div>
                            <?php if ($error_address) { ?>
                                <p class="col-sm-4"><?php echo $error_address; ?></p>
                            <?php } ?>
                        </div>
                        <!--邮箱-->
                        <div class="form-group">
                            <label for="inputEmail6" class="col-sm-4 control-label">邮箱：</label>
                            <div class="col-sm-4">
                                <input type="text" name="email" value="{$email}" class="form-control" id="inputEmail6" placeholder="邮箱">
                            </div>
                            <?php if ($error_email) { ?>
                                <p class="col-sm-4"><?php echo $error_email; ?></p>
                            <?php } ?>
                        </div>
                        <!--密码-->
                        <div class="form-group">
                            <label for="inputEmail7" class="col-sm-4 control-label">密码：</label>
                            <div class="col-sm-4">
                                <input type="password" name="pwd" value="{$pwd}" class="form-control" id="inputEmail7" placeholder="密码">
                            </div>
                            <?php if ($error_pwd) { ?>
                                <p class="col-sm-4"><?php echo $error_pwd; ?></p>
                            <?php } ?>
                        </div>
                        <!--确认密码-->
                        <div class="form-group">
                            <label for="inputEmail8" class="col-sm-4 control-label">确认密码：</label>
                            <div class="col-sm-4">
                                <input type="password" name="repwd" value="{$repwd}" class="form-control" id="inputEmail8" placeholder="确认密码">
                            </div>
                            <?php if ($error_repwd) { ?>
                                <p class="col-sm-4"><?php echo $error_repwd; ?></p>
                            <?php } ?>
                        </div>
                        <!--手机号-->
                        <div class="form-group">
                            <label for="inputEmail9" class="col-sm-4 control-label">手机号：</label>
                            <div class="col-sm-4">
                                <input type="text" name="telephone" value="{$telephone}" class="form-control" id="regName" placeholder="手机号">
                            </div>
                            <?php if ($error_telephone) { ?>
                                <p class="col-sm-4" style="color:red;"><?php echo $error_telephone;?></p>
                            <?php } ?>
                        </div>
                        <!--验证码-->
                        <div class="form-group">
                            <label for="inputEmail10" class="col-sm-4 control-label">验证码：</label>
                            <div class="col-sm-2">
                                <input type="text" class="form-control" name="mobile_code" id="securityCode">
                            </div>
                            <div class="col-sm-2">
                                <input class="btn btn-success" id="zphone" type="button" value=" 获取手机验证码 "  onclick="get_mobile_code();">
                            </div>
                        </div>

                        <script type="text/javascript">
                            function get_mobile_code(){
                                $.post("{:U('Public/sms')}", {mobile:jQuery.trim($('#regName').val()),send_code:<?php echo $_SESSION['send_code'];?>}, 
                                    function(msg) {
                                    alert(jQuery.trim(unescape(msg)));
                                    if(msg=='提交成功'){
                                        RemainTime();
                                    }
                                });
                            };

                            var iTime = 59;
                            var Account;
                            function RemainTime(){
                                document.getElementById('zphone').disabled = true;
                                var iSecond,sSecond="",sTime="";
                                if (iTime >= 0){
                                    iSecond = parseInt(iTime%60);
                                    iMinute = parseInt(iTime/60)
                                    if (iSecond >= 0){
                                        if(iMinute>0){
                                        sSecond = iMinute + "分" + iSecond + "秒";
                                    }else{
                                        sSecond = iSecond + "秒后重新发送";
                                    }
                                }
                                    sTime=sSecond;
                                    if(iTime==0){
                                        clearTimeout(Account);
                                        sTime='获取手机验证码';
                                        iTime = 59;
                                        document.getElementById('zphone').disabled = false;
                                    }else{
                                        Account = setTimeout("RemainTime()",1000);
                                        iTime=iTime-1;
                                    }
                                }else{
                                    sTime='没有倒计时';
                                }
                                document.getElementById('zphone').value = sTime;
                            } 
                        </script>

                        <!--上传省份证-->
                        <style type="text/css">
                            div.spot{
                                        float: left;
                                        margin: 0 20px 0 0;
                                        width: 220px;
                                        min-height: 160px;
                                        border: 2px dashed #ddd;
                                    }
                                    .droparea {
                                        position: relative;
                                        text-align: center;
                                    }
                                    .droparea .instructions {
                                        opacity: 0.8;
                                        background-color: #cccccc;
                                        height: 25px;
                                        z-index: 10;
                                        zoom: 1;
                                        background-position: initial initial;
                                        background-repeat: initial initial;
                                        cursor: pointer;
                                    }
                                    .droparea div, .droparea input {
                                        position: absolute;
                                        top: 0;
                                        width: 100%;
                                        height: 100%; 
                                    }
                                    .droparea input {
                                        cursor: pointer;
                                        opacity: 0;
                                    }
                                    #uparea1,#uparea2,#uparea3,#uparea4{
                                        height: 170px;
                                        cursor: pointer;
                                    }
                        </style>

                        <div class="row">
                            <div class="col-sm-2">
                                <h3>上传证件</h3>
                            </div>
                            <div class="col-sm-3">
                                <div class="droparea spot" id="image1" style="background-image: url('__UPLOAD__/image/regimage/{$info.idcadeimage1}');background-size: 220px 160px;" >
                                    <div class="instructions" onclick="del_image('1')">删除</div><div id="uparea1"></div>
                                    <input type="hidden" name="idcadeimage1" id="image_1" value="__UPLOAD__/image/regimage/{$info.idcadeimage1}" />
                                </div>
                            </div>
                            <div class="col-sm-3">
                                <div class="droparea spot" id="image2" style="background-image: url('__UPLOAD__/image/regimage/{$info.idcadeimage2}');background-size: 220px 160px;" >
                                    <div class="instructions" onclick="del_image('2')">删除</div><div id="uparea2"></div>
                                    <input type="hidden" name="idcadeimage2" id="image_2" value="__UPLOAD__/image/regimage/{$info.idcadeimage2}" />
                                </div>
                            </div>
                            <div class="col-sm-3">
                                <div class="droparea spot" id="image3" style="background-image: url('__UPLOAD__/image/regimage/{$info.addressimage}');background-size: 220px 160px;" >
                                    <div class="instructions" onclick="del_image('3')">删除</div><div id="uparea3"></div>
                                    <input type="hidden" name="addressimage" id="image_3" value="__UPLOAD__/image/regimage/{$info.addressimage}" />
                                </div>
                            </div>
                        </div>

                        <js href="__PUBLIC__/kindeditor/kindeditor.js,__PUBLIC__/kindeditor/lang/zh_CN.js"/>
                        <script type="text/javascript">
                            function del_image(num) {
                                $('#image' + num).css('background-image', '');
                                $('#image_' + num).val('');
                            }
                            $(function() {

                                // var content;
                                // KindEditor.ready(function(K) {
                                //     content = K.create('#content', {
                                //         allowFileManager: true,
                                //         uploadJson: '__PUBLIC__/kindeditor/php/upload_json.php?dirname=joinmessage'
                                //     });
                                // });

                                KindEditor.ready(function(K) {
                                    K.create();
                                    var editor = K.editor({
                                        allowFileManager: true,
                                        uploadJson: '__PUBLIC__/kindeditor/php/upload_json.php?dirname=regimage'
                                    });
                                    K('#uparea1').click(function() {
                                        editor.loadPlugin('image', function() {
                                            editor.plugin.imageDialog({
                                                imageUrl: K('#image_1').val(),
                                                clickFn: function(url, title, width, height, border, align) {
                                                    $('#image1').css('background-image', 'url(' + url + ')').css('background-size', '220px 160px');
                                                    K('#image_1').val(url);
                                                    // K('#getImgUrl').val(url);
                                                    editor.hideDialog();
                                                }
                                            });
                                        });
                                    });
                                    K('#uparea2').click(function() {
                                        editor.loadPlugin('image', function() {
                                            editor.plugin.imageDialog({
                                                imageUrl: K('#image_2').val(),
                                                clickFn: function(url, title, width, height, border, align) {
                                                    $('#image2').css('background-image', 'url(' + url + ')').css('background-size', '220px 160px');
                                                    K('#image_2').val(url);
                                                    // K('#getImgUrl').val(url);
                                                    editor.hideDialog();
                                                }
                                            });
                                        });
                                    });
                                    K('#uparea3').click(function() {
                                        editor.loadPlugin('image', function() {
                                            editor.plugin.imageDialog({
                                                imageUrl: K('#image_3').val(),
                                                clickFn: function(url, title, width, height, border, align) {
                                                    $('#image3').css('background-image', 'url(' + url + ')').css('background-size', '220px 160px');
                                                    K('#image_3').val(url);
                                                    // K('#getImgUrl').val(url);
                                                    editor.hideDialog();
                                                }
                                            });
                                        });
                                    });
                                });
                                // $("#checkNewsTitle").click(function() {
                                //     if ($('#title').val() == '') {
                                //         popup.error('标题不能为空！');
                                //         return false;
                                //     }
                                //     $.getJSON("__URL__/checkProductTitle", {title: $("#title").val(), id: "{$info.id}"}, function(json) {
                                //         $("#checkNewsTitle").css("color", json.status == 1 ? "#0f0" : "#f00").html(json.info);
                                //     });
                                // });
                                // $(".submit").click(function() {
                                //     if ($('#title').val() == '') {
                                //         popup.error('标题不能为空！');
                                //         return false;
                                //     }
                                //     content.sync();
                                //     commonAjaxSubmit("{$action_url}");
                                //     return false;
                                // });
                            });
                        </script>

                        <!--用户名协议-->
                        <div class="row">
                            <div class="col-sm-2">
                                <h5>用户注册协议*</h5>
                            </div>
                            <div class="form-group ">
                                <div class="checkbox col-lg-offset-5">
                                    <label><input type="checkbox" id="isread" name="isread" value="1" checked="checked"><span>我已阅读并同意 <a href="javascript:void(0)">《用户注册协议》</a></span></label>
                                </div>
                            </div>
                        </div>
                        <button type="submit" value="提交" id="btnQuery" class="btn btn-primary col-lg-offset-6">点击提交</button>
                    </div>
                </from>
                <script>
                    $(function () {
                        $('#btnQuery').click(function () {
                            var select2_chosen_1=$('#select2-chosen-1').html(); //省份
                            var select2_chosen_2=$('#select2-chosen-2').html(); //城市
                            var select2_chosen_3=$('#select2-chosen-3').html(); //区县

                            // $('#loc_province_ok').val(select2_chosen_1);
                            // $('#loc_city_ok').val(select2_chosen_2);
                            // $('#loc_town_ok').val(select2_chosen_3);

                            $("input[name='loc_province']").val(select2_chosen_1);
                            $("input[name='loc_city']").val(select2_chosen_2);
                            $("input[name='loc_town']").val(select2_chosen_3);
                        });
                    })
                </script>
            </div>
        </div>
    </div>
</div>

<style>
    .verifyimg{cursor:pointer;}
</style>
<script>
    //刷新验证码
    var verifyimg = $(".verifyimg").attr("src");
    $(".reloadverify").click(function(){
        if( verifyimg.indexOf('?')>0){
            $(".verifyimg").attr("src", verifyimg+'&random='+Math.random());
        }else{
            $(".verifyimg").attr("src", verifyimg.replace(/\?.*$/,'')+'?'+Math.random());
        }
    }); 
</script>

<div class="foot">
    <div class="top">
        <ul class="clearfix">
            <li><a href="">关于我们</a><span>|</span></li>
            <li><a href="">产品中心</a><span>|</span></li>
            <li><a href="">动态专栏</a><span>|</span></li>
            <li><a href="">联系我们</a><span>|</span></li>
            <li><a href="">友情链接</a></li>
        </ul>
        <p>
            <span>上海</span>
            <span>无锡</span>
            <span>济南</span>
            <span>武汉</span>
            <span>广州</span>
        </p>
    </div>
    <div class="center">
        <img src="__RES__/images/senmous-img.jpg" alt="">
    </div>
    <div class="bootom">
        © 2015 NEXTEV LIMITED All Rights Reserved 沪ICP备15026264号-1
    </div>
</div>

<script src="__RES__/js/bootstrap.js"></script>
</body>
</html>